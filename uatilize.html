<!DOCTYPE html>
<!--
	Copyright(c) 2014 Suphanut Jamonnak, Dr.En Cheng
	Data Integration Spring 2014 - UAtilize
-->
<html>
  <head>
  <style>
    #map-canvas { width:1280px; height:500px; }
    .layer-wizard-search-label { font-family: sans-serif };
  </style>
  <script type="text/javascript"
    src="http://maps.google.com/maps/api/js?sensor=false">
  </script>
  <script type="text/javascript">
    var map;
    var layer;
    function initialize() {
      			map = new google.maps.Map(document.getElementById('map-canvas'), {
        		center: new google.maps.LatLng(41.076929, -81.510242),
                zoom: 17,
                maxZoom: 17,
                minZoom: 14,
                zoomControlOptions:{  	style: google.maps.ZoomControlStyle.LARGE,
                                      	position: google.maps.ControlPosition.left_top},
                      				  	mapTypeId: google.maps.MapTypeId.ROADMAP,
                      					//Turn off the map controls as we will be adding our own later.
                      					panControl: false,
                     					  mapTypeControl: false,
                      					streetViewControl: false
      			});
      var style = [
					  {
					    "featureType": "road.local",
					    "elementType": "geometry",
					    "stylers": [
					      { "hue": "#00ff22" },
					      { "weight": 2.2 }
					    ]
					  },{
					    "featureType": "road.highway",
					    "elementType": "geometry",
					    "stylers": [
					      { "hue": "#ff0011" }
					    ]
					  },{
					    "featureType": "road.arterial",
					    "elementType": "geometry",
					    "stylers": [
					      { "weight": 3.2 },
					      { "color": "#30713d" }
					    ]
					  },{
					    "featureType": "road.arterial",
					    "stylers": [
					      { "invert_lightness": true },
					      { "hue": "#00ff4d" }
					    ]
					  },{
					    "featureType": "water",
					    "stylers": [
					      { "hue": "#2200ff" }
					    ]
					  },{
					    "featureType": "landscape.man_made",
					    "elementType": "geometry",
					    "stylers": [
					      { "weight": 0.1 },
					      { "invert_lightness": true },
					      { "hue": "#1900ff" }
					    ]
					  },{
					    "featureType": "poi.school",
					    "elementType": "geometry",
					    "stylers": [
					      { "color": "#B9F2BE" }
					    ]
					  },{
					    "featureType": "poi",
					    "stylers": [
					      { "invert_lightness": true },
					      { "hue": "#00ccff" }
					    ]
					  },{
					    "featureType": "landscape"  },{
					    "featureType": "poi.school",
					    "stylers": [
					      { "weight": 8 }
					    ]
					  }
					];
      var styledMapType = new google.maps.StyledMapType(style, {
        map: map,
        name: 'Styled Map'

      });

      map.mapTypes.set('map-style', styledMapType);
      map.setMapTypeId('map-style');

      layer = new google.maps.FusionTablesLayer({
        query: {
          //www.google.com/fusiontables/embedviz?viz=GVIZ&t=TABLE&q=select+col2%2C+col3%2C+count()%2C+SUM(col17)+from+18TOgNuPcj8Ty5j1NZE55YEtEh99XM120K_4e_gLK+group+by+col2%2Ccol3&containerId=googft-gviz-canvas
          
          select: "col5",
          from: "18TOgNuPcj8Ty5j1NZE55YEtEh99XM120K_4e_gLK",	
          groupby: "Bldg_Name",
        },
        
        //styleId: 3,
        //templateId: 1
      });
      layer.setMap(map);
      

      // Show Heat map
      google.maps.event.addDomListener(document.getElementById('heatmap'),
            'click', function() {
              var heatmap = document.getElementById('heatmap');
              layer.setOptions({
                heatmap: {
                  enabled: heatmap.checked
                }
              });
        });
    }

    

    function changeMap_0() {
      var whereClause;
      var searchString = document.getElementById('search-string_0').value.replace(/'/g, "\\'");
      if (searchString != '--Select--') {
        whereClause = "'Bldg_Name' CONTAINS IGNORING CASE '" + searchString + "'";
      }
      layer_0.setOptions({
        query: {
          select: "col5",
          from: "18TOgNuPcj8Ty5j1NZE55YEtEh99XM120K_4e_gLK",
          where: whereClause
        }
      });

    }
    google.maps.event.addDomListener(window, 'load', initialize);

    

  </script>
  </head>
  <body>
  	<div style="margin-top: 10px;">
      <label class="layer-wizard-search-label">
        Search Building
        <input type="text" id="search-string_0">
        <input type="button" onclick="changeMap_0()" value="Search">
      </label> 
    </div>
    <div id="map-canvas" style = "margin-top: 10px;"></div>
    <div>
      <input id="heatmap" type="checkbox" />
      <label>Enable heatmap</label>
    </div>
  </body>
</html>
